<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Debug Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    button { padding: 10px 20px; margin: 10px; }
    #output { margin-top: 20px; padding: 10px; background: #f0f0f0; }
  </style>
</head>
<body>
  <h1>Debug Calculator</h1>
  
  <button onclick="testDataLoading()">Test Data Loading</button>
  <button onclick="testCalculation()">Test Calculation</button>
  <button onclick="testMainPage()">Test Main Page Elements</button>
  
  <div id="output"></div>

  <script>
    function log(message) {
      console.log(message);
      document.getElementById('output').innerHTML += '<p>' + message + '</p>';
    }

    async function testDataLoading() {
      log('=== Testing Data Loading ===');
      try {
        const response = await fetch('data/percentiles.json');
        log('Response status: ' + response.status);
        
        if (!response.ok) {
          throw new Error('Failed to fetch data: ' + response.status);
        }
        
        const data = await response.json();
        log('Data loaded successfully!');
        log('Available age groups for males: ' + Object.keys(data.by_age.male).join(', '));
        log('Available weight groups for males: ' + Object.keys(data.by_weight.male).join(', '));
        
        // Test a specific dataset
        const testData = data.by_age.male["25"];
        log('Test dataset for 25-year-old male: ' + JSON.stringify(testData));
        
      } catch (error) {
        log('ERROR: ' + error.message);
      }
    }

    function testCalculation() {
      log('=== Testing Calculation ===');
      
      // Test interpolation function
      const testData = [
        {"bench": 103, "percentile": 5},
        {"bench": 154, "percentile": 20},
        {"bench": 217, "percentile": 50},
        {"bench": 291, "percentile": 80},
        {"bench": 372, "percentile": 95}
      ];
      
      log('Test data: ' + JSON.stringify(testData));
      
      // Test different bench press values
      const testValues = [100, 150, 200, 250, 300, 400];
      
      testValues.forEach(bench => {
        const percentile = interpolate(testData, bench);
        log(`Bench: ${bench} lbs â†’ Percentile: ${percentile}th`);
      });
    }

    function interpolate(data, bench) {
      if (!data || data.length === 0) return 0;
      
      if (bench <= data[0].bench) return data[0].percentile;
      if (bench >= data[data.length - 1].bench) return data[data.length - 1].percentile;
      
      for (let i = 0; i < data.length - 1; i++) {
        const a = data[i];
        const b = data[i + 1];
        
        if (bench >= a.bench && bench <= b.bench) {
          const ratio = (bench - a.bench) / (b.bench - a.bench);
          return Math.round(a.percentile + ratio * (b.percentile - a.percentile));
        }
      }
      return 0;
    }

    function testMainPage() {
      log('=== Testing Main Page Elements ===');
      log('This test will check if the main page elements exist when you visit the main page.');
      log('Please go to http://localhost:8000 and check the browser console for results.');
      
      // Try to access the main page elements
      const mainPageElements = [
        'calculator-form',
        'gender',
        'age',
        'weight',
        'bench',
        'compareBy',
        'result',
        'percentile-value',
        'strength-level',
        'strength-badge',
        'comparison-details'
      ];
      
      log('Elements to check on main page:');
      mainPageElements.forEach(id => {
        log(`- ${id}`);
      });
      
      log('Go to the main page and open browser console (F12) to see if these elements exist.');
    }
  </script>
</body>
</html> 